# 第1周问题列表与差距分析

## 1. 数据流水线问题
- **时区对齐**：原始数据使用 UTC/本地时间，而 SUMO 使用从 0 开始的相对秒数。`compare_week1.py` 成功加载了两者，但需要一个“模拟开始时间”锚点来计算绝对误差（RMSE）。
- **数据空白**：初始数据收集显示存在一些 > 5 分钟的空白（已在 `clean_kmb_eta.py` 中处理）。
- **缺失站点**：`generate_sumo_stops.py` 不得不跳过约 15 个站点，因为它们无法映射到 `hk_baseline.net.xml` 网络（距离任何路段均 > 100米）。

## 2. 仿真问题
- **路线连通性**：站点的线性序列存在空白，底层道路网络需要中间路段。已修补 `generate_sumo_routes.py` 以逻辑地填充空白（`edge_X` -> `edge_X+1`），但在复杂网络中，首选真实路由（Dijkstra）。
- **站点长度**：标准巴士站（10米）对于 12米长的九巴（KMB）来说太短，导致“车辆无法移动”错误。已增加到 15米。
- **未映射站点**：仿真中缺少几个站点（例如 `376C4835851621D4`），这将影响“总行程时间”的对比。

## 3. 指标与参数校准（Week 2 重点）
- **L1 指标**：目前计算为“平均到达时间”。为了更稳健，应将其转换为“站间行程时间”，以消除对绝对开始时间的依赖。
- **L2 指标**：路段速度尚未直接对比；待第 2 周生成 `link_speeds.csv` 后进行。
- **待校准占位参数 (Placeholders)**：
    - `Headway` (发车间隔): 目前设为 `600s` (定值)，需改为从真实 ETA/时刻表推算的动态间隔。
    - `Dwell Time` (停站时间): 目前设为 `20s` (定值)，需改为 `t_board` (上客时间) 或分布函数。
    - `Vehicle Params`: `accel=2.5`, `decel=4.5`, `sigma=0.5` 均为 SUMO 缺省或经验值，需通过 BO 进行参数反演。

## 4. 下一步计划（第 2 周）
- [ ] 利用全港高精度路网文件 `data/RdNet_IRNP.gdb` (IRN) 重建或校准 SUMO 网络，彻底解决站点缺失和拓扑连接问题。
- [ ] 实施基于 `traci` 的路由或正确的 `duarouter` 使用，以获得精确路径。
- [ ] 归一化真实与仿真时间戳：将 SUMO 仿真开始时间 ($T=0$) 严格设定为首个清洗后公交数据的真实时间戳 (First Observation Time)，以便进行准确的 RMSE 计算。
